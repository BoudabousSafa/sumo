<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Developer/CodeStyle</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From Sumo</div>
								<div id="contentSub"></div>
												
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#C.2B.2B_Code"><span class="tocnumber">1</span> <span class="toctext">C++ Code</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Templates"><span class="tocnumber">1.1</span> <span class="toctext">Templates</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Whitespace"><span class="tocnumber">1.2</span> <span class="toctext">Whitespace</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Class_Names"><span class="tocnumber">1.3</span> <span class="toctext">Class Names</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Variable_Names"><span class="tocnumber">1.4</span> <span class="toctext">Variable Names</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Enums"><span class="tocnumber">1.5</span> <span class="toctext">Enums</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Encoding"><span class="tocnumber">1.6</span> <span class="toctext">Encoding</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.23include-statements"><span class="tocnumber">1.7</span> <span class="toctext">#include-statements</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#.22using_namespace_....22-statements"><span class="tocnumber">1.8</span> <span class="toctext">"using namespace ..."-statements</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Throw-declarations"><span class="tocnumber">1.9</span> <span class="toctext">Throw-declarations</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Object_Handling"><span class="tocnumber">1.10</span> <span class="toctext">Object Handling</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Integer_Types"><span class="tocnumber">1.11</span> <span class="toctext">Integer Types</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Conditionals"><span class="tocnumber">1.12</span> <span class="toctext">Conditionals</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Loops"><span class="tocnumber">1.13</span> <span class="toctext">Loops</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Python_Code"><span class="tocnumber">2</span> <span class="toctext">Python Code</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Python3_compatibility"><span class="tocnumber">2.1</span> <span class="toctext">Python3 compatibility</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Template"><span class="tocnumber">2.2</span> <span class="toctext">Template</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Line_endings_and_keyword_replacement"><span class="tocnumber">3</span> <span class="toctext">Line endings and keyword replacement</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Checking_code_style"><span class="tocnumber">4</span> <span class="toctext">Checking code style</span></a></li>
</ul>
</div>

<h1><span class="mw-headline" id="C.2B.2B_Code">C++ Code</span></h1>
<p>For the C++ code we use <a rel="nofollow" class="external text" href="http://astyle.sourceforge.net/">AStyle</a> to keep indentation and other whitespace usage consistent throughout the project. In order to make your code appear same as the original SUMO code use the following call to AStyle (or execute tools/build/apply_astyle.py before committing):
</p>
<pre>astyle --style=java --unpad-paren --pad-header --pad-oper --add-brackets --indent-switches --align-pointer=type -n &lt;FILE_NAME&gt;
</pre>
<p>Still, there are several other things you should keep in mind (The <a rel="nofollow" class="external text" href="https://google.github.io/styleguide/cppguide.html">Google C++ Style Guide</a> is a good read as well):
</p>
<h2><span class="mw-headline" id="Templates">Templates</span></h2>
<p>Use the following templates for your files:
</p>
<ul><li> <a href="../Developer/CppFileTemplate.html" title="Developer/CppFileTemplate">Developer/CppFileTemplate</a></li>
<li> <a href="../Developer/HFileTemplate.html" title="Developer/HFileTemplate">Developer/HFileTemplate</a></li>
<li> <a href="../Developer/PyFileTemplate.html" title="Developer/PyFileTemplate">Developer/PyFileTemplate</a></li></ul>
<h2><span class="mw-headline" id="Whitespace">Whitespace</span></h2>
<ul><li> Never use <i>tab stop</i>. Only use <i>space</i>. In Visual Studio <i>tab stop</i> can be disabled in Tools/Options/Text Editor/All languages/Tabs</li></ul>
<h2><span class="mw-headline" id="Class_Names">Class Names</span></h2>
<ul><li> All class names must start with capital letter</li>
<li> The first capital letters of a class must indicates their module (<b>NB</b>Edge -&gt; <b>N</b>et <b>B</b>uild module, <b>MS</b>ChargingStation -&gt; <b>M</b>icro <b>S</b>imulation module</li>
<li> If a class name is composed of multiple words, every word must start with capital letter (Micro simulation charging station -&gt; <b>MSC</b>harging<b>S</b>tation)</li></ul>
<h2><span class="mw-headline" id="Variable_Names">Variable Names</span></h2>
<ul><li> Variables used within methods should be named using "camel-caps", f.e. "currentCarVelocity"</li>
<li> Member variables should additionally have the prefix "my", f.e. "myMaximumVehicleVelocity"</li>
<li> try not to abbreviate variable names (myMaximumVehicleVelocity instead of myMVV)</li>
<li> give names to variables which describe its purpose within the context</li>
<li> do not reuse variables for different purposes</li></ul>
<h2><span class="mw-headline" id="Enums">Enums</span></h2>
<ul><li> All enum names must start with capital letter, and If their name is composed of multiple words, every word must start with capital letter</li>
<li> All every definition must be written using capital letters (SumoXMLTag { <b>SUMO_TAG_EDGE</b>, <b>SUMO_TAG_LANE</b>,...)</li></ul>
<h2><span class="mw-headline" id="Encoding">Encoding</span></h2>
<p>Only use the plain <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/ASCII">ASCII</a> characters in <i>cpp</i> and <i>h</i> files. (0x20 - 0x7E). If you need convey extended character information use TeX or HTML notation instead.
</p>
<h2><span class="mw-headline" id=".23include-statements">#include-statements</span></h2>
<ul><li> <b>do not use backslashes (\)!</b> use slashes (/) only</li>
<li> <b>do not use absolute paths!</b>; something like #include "/home/daniel/mylibs/include_me.h" will never work somewhere else! Use relative paths and tell the compiler where the other libraries may be found. If you have problems on this, please tell us, we'll write some further documentation!</li>
<li> in general we mention the standard library includes first (like #include &lt;vector&gt;), then the includes of libraries used by SUMO (FOX / Xerces) and later our own headers</li>
<li> brackets ("&lt;" and "&gt;") are preferred for files not residing in the same directory, while quotation marks are usually used for files in the same directory.</li></ul>
<h2><span class="mw-headline" id=".22using_namespace_....22-statements">"using namespace ..."-statements</span></h2>
<ul><li> Avoid them whenever possible and especially <b>do not use "using namespace ..."-statements within the .h-files!</b> It's possible that an included library tries to use a different impementation - who knows? Using a "using namespace ..."-statement within your .h-file may yield in an unexpected behaviour.</li></ul>
<h2><span class="mw-headline" id="Throw-declarations">Throw-declarations</span></h2>
<ul><li> We are not using throw-declarations, see: <a rel="nofollow" class="external free" href="http://www.gotw.ca/publications/mill22.htm">http://www.gotw.ca/publications/mill22.htm</a> (thanks to Bj√∂rn Hendriks); we'll remove the existing ones subsequently.</li></ul>
<h2><span class="mw-headline" id="Object_Handling">Object Handling</span></h2>
<ul><li> If the structure you are implementing has an id, then derive the object from <code>Named</code> (<i><b>&lt;SUMO_HOME&gt;</b></i>/src/utils/common/Named.h). This class supports the <code>std::string getID()</code>-method.</li>
<li> If you want to store something in a map pointing from string ids to object instances, then use <code>NamedObjectCont</code> (<i><b>&lt;SUMO_HOME&gt;</b></i>/src/utils/common/NamedObjectCont.h).</li></ul>
<h2><span class="mw-headline" id="Integer_Types">Integer Types</span></h2>
<ul><li> Use simple int whenever possible. There are probably lots of places in the sumo code which rely on the fact that this has at least 32 bits, so you may too.</li>
<li> Try to avoid unsigned ints whenever possible. It is sometimes not possible when calling Xerces-C and GL functions or using std::string::npos but try to limit it to those cases.</li>
<li> If you need at least 64 bit, use long long int.</li></ul>
<h2><span class="mw-headline" id="Conditionals">Conditionals</span></h2>
<ul><li> Do not use redundant condition checks. Example: <i><b>if</b> (myCondition)</i> instead of <i><b>if</b> (myCondition == <b>true</b>)</i></li></ul>
<h2><span class="mw-headline" id="Loops">Loops</span></h2>
<ul><li> Use always as possible the C++ 11 syntax. Example: <i><b>for</b> (<b>auto</b> it&#160;: myContainer)</i> instead of <i><b>for</b> (container::iterator it = myContainer.begin(); it&#160;!= myContainer.end(); it++)</i></li></ul>
<p><br />
</p>
<h1><span class="mw-headline" id="Python_Code">Python Code</span></h1>
<p>We try to adhere to the <a rel="nofollow" class="external text" href="http://www.python.org/dev/peps/pep-0008/">PEP 8 Style Guide</a>. Please remember to make your file executable if (and only if) the file should be executable (i.e. is not a module to be imported by others). Windows users please follow this <a rel="nofollow" class="external text" href="https://stackoverflow.com/questions/21691202/how-to-create-file-execute-mode-permissions-in-git-on-windows">recipe</a>. Executable files should also contain a so called shebang in the first line:
</p>
<pre>!#/usr/bin/env python
</pre>
<h2><span class="mw-headline" id="Python3_compatibility">Python3 compatibility</span></h2>
<p>Our main development still focusses on Python 2.7 but we strive for Python 3 compatibility. When writing or editing scripts, keep the following in mind:
</p>
<ul><li> use <i>print</i> as a function (<code>from __future__ import print_function</code>)</li>
<li> use <i>items</i> instead of iteritems, which will return a list under Python 2.7 and an iterator in Python 3(<code>for item in dict.items() </code>)</li>
<li> use <i>values</i> instead of <i>itervalues</i>, which will return a list under Python 2.7 and an iterator in Python 3(<code>for val in dict.values() </code>)</li>
<li> use <i>//</i> instead of <i>/</i> for integer division because <i>/</i> will do a floating point division under Python 3 (<code>4/3 = 1.3333333</code>)</li>
<li> the floating point division with <i>/</i> can be included in Python 2 by (<code>from __future__ import division</code>)</li>
<li> while iterating over unsorted lists or iterators Python 2 and Python 3 do not work in the same order. Therefore add a explicit <i>sorted</i> before iteration when you write e.g. a xml file (<code>for item in sorted(list)</code>)</li>
<li> use argparse library instead for optparse due to optparse wont be updated for Python 3 anymore. The use of most functions stayed the same, only some names differ. For further information please check <a rel="nofollow" class="external free" href="https://docs.python.org/3/library/argparse.html">https://docs.python.org/3/library/argparse.html</a></li>
<li> if you want to use different code for Python 2 and Python 3, which can be necessary since not all libraries exist for both versions, you can use a simple if else statement with the PY3 boolean defined by(<code>PY3 = sys.version_info &gt; (3,)</code>)</li>
<li> use byte type in python 3 wherever you use binary data and string type wherever you used unicode strings before. This can be made by if else statements using the PY3 boolean. See a list for the different methods possible on bytes and strings at <a rel="nofollow" class="external free" href="https://docs.python.org/3/howto/pyporting.html#text-versus-binary-data">https://docs.python.org/3/howto/pyporting.html#text-versus-binary-data</a></li></ul>
<p>For further information about possible error sources and difficulties resulting in Python 3 compatibility see also <a rel="nofollow" class="external free" href="http://python3porting.com/">http://python3porting.com/</a> and <a rel="nofollow" class="external free" href="https://docs.python.org/3/howto/pyporting.html">https://docs.python.org/3/howto/pyporting.html</a>
</p>
<h2><span class="mw-headline" id="Template">Template</span></h2>
<p>Use the following template for your files:
</p>
<ul><li> <a href="../Developer/PythonFileTemplate.html" title="Developer/PythonFileTemplate">Developer/PythonFileTemplate</a></li></ul>
<h1><span class="mw-headline" id="Line_endings_and_keyword_replacement">Line endings and keyword replacement</span></h1>
<p>We enforce special line endings for the following file types (overriding core.autocrlf settings of git) using <a rel="nofollow" class="external text" href="https://github.com/eclipse/sumo/blob/master/.gitattributes"><i><b>&lt;SUMO_HOME&gt;</b></i>/.gitattributes</a>:
</p>
<ul><li> LF for
<ul><li> source files (".h", ".cpp", ".py", ...),</li>
<li> Test files (".xml", ".prog", ".complex", ".dfrouter", ".duarouter", ".jtrrouter", ".netconvert", ".sumo", ".meso", ...)</li></ul></li>
<li> CRLF for Windows only files (".bat", ".props", ".vcxproj", ".filters", ...)</li></ul>
<p>Git has no equivalent to the svn:keywords property. We use a custom script to handle the $Id$ keyword like before but it has to be enabled manually by adding the following lines to your global .gitconfig (usually in your home directory)
</p>
<pre>  [filter "keywords"]
      clean  = .git_filters/keywords.py clean
      smudge = .git_filters/keywords.py&#160;%f
</pre>
<p>The filter is enabled for Python and C++ source files.
</p><p>For the current settings you can always look at <a rel="nofollow" class="external text" href="https://github.com/eclipse/sumo/blob/master/.gitattributes"><i><b>&lt;SUMO_HOME&gt;</b></i>/.gitattributes</a>.
</p>
<h1><span class="mw-headline" id="Checking_code_style">Checking code style</span></h1>
<p>There is a python script checking (and optionally enforcing) some code style including the header format in <a rel="nofollow" class="external text" href="https://github.com/eclipse/sumo/blob/master/tools/build/checkStyle.py"><i><b>&lt;SUMO_HOME&gt;</b></i>/tools/build/checkStyle.py</a>.
</p>
<!-- 
NewPP limit report
CPU time usage: 0.024 seconds
Real time usage: 0.025 seconds
Preprocessor visited node count: 106/1000000
Preprocessor generated node count: 166/1000000
Post‚Äêexpand include size: 418/2097152 bytes
Template argument size: 106/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.430      1 - -total
 51.94%    2.820      3 - Template:Source
 34.05%    1.849      5 - Template:SUMO
-->

<!-- Saved in parser cache with key sumoSimWiki:pcache:idhash:22-0!*!0!!en!*!* and timestamp 20181011091627 and revision id 10304
 -->
</div>									</div><hr/><div id="lastmod">This page was last modified on 5 November 2017, at 22:34.</div>